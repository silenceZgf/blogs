# 脚本连接远程桌面
> 对于windows 服务器, 通常只能通过远程桌面来进行操作, 而windows 提供了远程桌面的工具, 使用起来是很方便的,但是也是比较麻烦的.对于一个技术控而言, 对于这种繁琐且无脑的工作是不能接受的.笔者本着:只要有规律地事情,就可以自动化解决的宗旨, 通过mstsc 命令写了几个自动远程连接的VB脚本.


# 1. 第一次远程连接
第一次远程连接服务器稍微比较麻烦,需要设置服务器ip地址, 用户名, 密码, 共享磁盘等信息. 只要设置完成之后, 以后再连接时就比较简单了.

## 1.1 打开运行窗口
使用 windows 键 + R 打开运行窗口, 输入mstsc, 点确定
![](/assets/win_2017-07-11_122535.png)

## 1.2 输入服务器ip 和用户名
在常规选项中, 输入服务器ip 和 用户名, 并勾选允许我保存凭据. 否则的话每次连接都必须输入密码, 比较麻烦.
![](/assets/win_2017-07-11_121443.png)

## 1.3 设置共享目录
点击本地资源选项卡, 点击详细信息
![](/assets/win_2017-07-11_121602.png)

## 1.4 设置要共享的磁盘
点击驱动器, 选择要共享的磁盘. 选择共享的磁盘会在远程连接窗口中的我的电脑中显示, 这是为了实现本地与windows服务器之间文件传输的功能.
![](/assets/win_2017-07-11_121642.png)

## 1.5 输入用户名对应的 密码
![](/assets/win_2017-07-11_121742.png)

## 1.6 打开服务器的计算机
在远程桌面窗口中,打开计算机, 会发现除了服务器原有的磁盘外,还多余了两个磁盘,而这两个磁盘就是你本地的磁盘.通过本地磁盘和远程服务器的磁盘之间文件的拷贝就可以完成服务器与本地直接的文件传输.
* 上传文件: 拷贝本地磁盘的文件到远程服务器
* 下载文件: 拷贝远程服务器磁盘中的文件到本地磁盘
![](/assets/win_2017-07-11_121859.png)

## 1.7 下载文件
下载的复制粘贴操作都是在远程桌面窗口中进行的:
1. 进入服务器D 盘, 选择文件, 复制
2. 进入本地F 盘, 粘贴

![](/assets/win_2017-07-11_123512.png)


# 2. 第二次远程连接
对于记住凭据之后的远程连接就比较简单了, 连接步骤为:
1. 通过win+R 快速打开运行窗口
2. 输入mstsc, 连接确定
3. 选择服务器ip 地址
4. 点击连接即可

#3. 远程连接脚本
记住密码之后, 第二次连接就比较简单, 但是也有四步操作. 对于以懒为荣的程序员来说, 这四步都很麻烦, 希望能直接双击脚本就能自动完成远程连接工作. 笔者使用的是VB脚本, 因为VB 脚本设置后台运行比较方便.

## 3.1 新建脚本:mstsc@100.vbs
* 脚本文件名后缀必须为.vbs
* 脚本名称建议按规律写, 笔者命名规范为: mstsc@ip.vbs  或  mstsc@ip@username.vbs
* 注意文件图标, 如果文件图标不对的话, 有可能是系统设置了隐藏文件后缀名, 也就是说你看到的是mstsc@100.vbs, 而实际却是 mstsc@100.vbs.txt
![](/assets/win_2017-07-11_134925.png)

## 3.2 使用文本工具编辑
* 笔者使用notepad++编辑文件: 点击文件, 鼠标右键, 选择 Edit with notepad++

mstsc@100 文件内容:
```vb
' 设置变量:远程服务器ip
ip = "192.168.145.100"

' 创建后台对象
Set ws = CreateObject("Wscript.Shell")

' 后台启动远程桌面系统
ws.run "mstsc /v:" & ip,1
```

## 3.2 执行脚本
* 双击脚本mstsc@100.vbs 文件即可
![](/assets/win_2017-07-11_133906.png)


# 4. 环境变量设置
对于使用脚本进行远程连接的方式, 通常笔者会将文件都放在桌面上的某个文件夹中, 那么需要进行远程连接的时候, 需要先进入文件夹, 然后执行文件. 每次都必须回到文件夹, 也是比较麻烦的事情.那么我们设置一下环境变量:

## 4.1 将所有远程连接脚本都存储在d:/scripts目录中
![](/assets/win_2017-07-11_134925.png)

## 4.2 将d:/scripts 目录添加到环境变量中
点击我的电脑, 右键属性, 高级系统设置, 环境变量,系统变量中编辑PATH, 末尾添加 ;d:/scripts 即可

## 4.3 远程连接服务器
1. 使用win+R  快速打开运行窗口
2. 输入脚本名称(输入一次之后, 再打开直接点击下拉框选择即可)
![](/assets/win_2017-07-11_141700.png)

# 5. 总结
对于这三种连接方式来讲, 差别并不大, 但是笔者倾向于第二或第三种连接方式, 将懒发扬光大:

普通方式:
1. win+R 打开运行窗口
2. 输入mstsc 命令, 打开远程连接窗口
2. 选择要连接的服务器, 点击链接

脚本方式1:
1. win+D 快速回到桌面
2. 进入脚本文件夹
3. 双击脚本文件

脚本方式2:
1. win+R 快速打开运行窗口
2. 输入或选择脚本名称, 按Enter 键即可



















